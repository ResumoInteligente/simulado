<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Painel Resumo Inteligente</title>
<style>
    :root {
        --primary: #2563eb;
        --primary-dark: #1e40af;
        --background: #0d1117;
        --card: #111827;
        --text-light: #60a5fa;
        --danger: #dc2626;
        --success: #22c55e;
    }
    * { box-sizing: border-box; }
    body {
        margin: 0;
        font-family: "Inter", sans-serif;
        background: radial-gradient(circle at top left, #0a0f1a, var(--background));
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        height: 100vh;
        overflow: hidden;
    }
    .container {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 60px;
        flex-wrap: wrap;
        padding: 20px;
    }
    .logo-section {
        display: flex;
        flex-direction: column;
        align-items: center;
        text-align: center;
    }
    .logo {
        width: 220px;
        height: auto;
        filter: drop-shadow(0 0 6px #1e40af);
    }
    .logo-title {
        margin-top: 15px;
        font-size: 20px;
        font-weight: 600;
        color: var(--text-light);
        letter-spacing: 1px;
        text-shadow: 0 0 8px rgba(96, 165, 250, 0.5);
    }
    .card {
        background: var(--card);
        padding: 30px;
        border-radius: 15px;
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.4);
        width: 360px;
        max-width: 90vw;
        display: flex;
        flex-direction: column;
        animation: fadeIn 0.4s ease;
    }
    .tabs {
        display: flex;
        margin-bottom: 20px;
        border-radius: 15px 15px 0 0;
        overflow: hidden;
    }
    .tab {
        flex: 1;
        text-align: center;
        padding: 12px;
        cursor: pointer;
        background: #1e293b;
        color: white;
        font-weight: bold;
        border: none;
        transition: background 0.3s;
    }
    .tab.active {
        background: var(--primary);
    }
    .input-group {
        display: flex;
        flex-direction: column;
        gap: 15px;
        width: 100%;
        margin-bottom: 25px; /* espaçamento maior entre inputs e botão */
    }
    input {
        width: 100%;
        padding: 12px;
        border-radius: 8px;
        border: none;
        background: #1f2937;
        color: white;
        font-size: 15px;
    }
    input:focus {
        background: #243046;
        outline: none;
    }
    button {
        width: 100%;
        padding: 14px;
        background: var(--primary);
        color: white;
        border: none;
        border-radius: 8px;
        font-weight: bold;
        cursor: pointer;
        font-size: 15px;
        transition: 0.3s;
        margin-top: 10px;
    }
    button:hover {
        background: var(--primary-dark);
        transform: scale(1.03);
    }
    .error {
        color: var(--danger);
        text-align: center;
        font-size: 14px;
        margin-top: 5px;
    }
    .success {
        color: var(--success);
        text-align: center;
        font-size: 14px;
        margin-top: 5px;
    }
    #menu {
        display: none;
        flex-direction: column;
        align-items: center;
        text-align: center;
        padding: 20px;
        width: 100%;
        max-width: 500px;
        animation: fadeIn 0.5s ease;
    }
    #dashboard-logo {
        width: 180px;
        margin-bottom: 20px;
        filter: drop-shadow(0 0 6px #1e3a8a);
    }
    .button-group {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 16px;
        width: 100%;
    }
    .button-group button {
        background-color: var(--primary);
        color: white;
        border: none;
        border-radius: 8px;
        padding: 14px 22px;
        width: 100%;
        max-width: 280px;
        font-weight: bold;
        cursor: pointer;
        font-size: 15px;
        transition: 0.3s;
    }
    .button-group button:hover {
        background-color: var(--primary-dark);
        transform: scale(1.05);
    }
    #adminSection {
        display: none;
        background: var(--card);
        padding: 20px;
        border-radius: 15px;
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.4);
        width: 100%;
        max-width: 500px;
        margin-top: 25px;
        text-align: center;
        animation: fadeIn 0.4s ease;
    }
    #userList {
        width: 100%;
        border-collapse: collapse;
    }
    #userList th, #userList td {
        padding: 8px;
        border-bottom: 1px solid #2d3748;
    }
    #userList th {
        color: var(--text-light);
    }
    .delete-btn {
        background: var(--danger);
        border: none;
        color: white;
        padding: 5px 10px;
        border-radius: 6px;
        cursor: pointer;
        transition: 0.3s;
    }
    .delete-btn:hover {
        background: #b91c1c;
    }
    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(15px); }
        to { opacity: 1; transform: translateY(0); }
    }
    @media (max-width: 768px) {
        body {
            height: auto;
            min-height: 100vh;
            overflow-y: auto;
            padding: 30px 10px;
        }
        .container {
            flex-direction: column;
            gap: 30px;
        }
        .logo {
            width: 180px;
        }
        .card {
            width: 100%;
            max-width: 400px;
        }
    }
</style>
</head>
<body>

<div class="container" id="login-container">
  <div class="logo-section">
      <img class="logo" src="Logo.png" alt="Logo">
      <h2 class="logo-title">Painel Resumo Inteligente</h2>
  </div>

  <div class="card">
      <div class="tabs">
          <button id="loginTab" class="tab active">Login</button>
          <button id="registerTab" class="tab">Criar Conta</button>
      </div>

      <div id="login-form">
          <div class="input-group">
              <input type="email" id="login-email" placeholder="Email" required>
              <input type="password" id="login-password" placeholder="Senha" required>
          </div>
          <button id="loginBtn">Entrar</button>
          <p id="login-error" class="error"></p>
      </div>

      <div id="register-form" style="display: none;">
          <div class="input-group">
              <input type="text" id="register-name" placeholder="Nome" required>
              <input type="email" id="register-email" placeholder="Email" required>
              <input type="password" id="register-password" placeholder="Senha (mínimo 6 caracteres)" required>
          </div>
          <button id="registerBtn">Criar Conta</button>
          <p id="register-error" class="error"></p>
          <p id="register-success" class="success"></p>
      </div>
  </div>
</div>

<div id="menu">
  <img id="dashboard-logo" src="Logo.png" alt="Logo do Sistema">
  <h2 id="welcome-text">Bem-vindo!</h2>
  <p id="user-email-text"></p>

  <div class="button-group">
      <button id="accessSimulationBtn">Acessar Simulado</button>
      <button id="logoutBtn">Sair</button>
      <button id="adminPanel" style="display: none;">Gerenciamento de Contas</button>
  </div>

  <div id="adminSection">
      <h3>Gerenciamento de Contas</h3>
      <table id="userList">
          <thead><tr><th>Nome</th><th>Email</th><th>Ações</th></tr></thead>
          <tbody></tbody>
      </table>
  </div>
</div>

<!-- ====================== FIREBASE SCRIPT ====================== -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-app.js";
  import {
    getAuth,
    createUserWithEmailAndPassword,
    signInWithEmailAndPassword,
    deleteUser,
    signOut
  } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-auth.js";
  import {
    getFirestore,
    setDoc,
    doc,
    getDocs,
    collection,
    deleteDoc
  } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyCOEKDHS1deKl13Mp9aU3NcM1JzT0pW7r8",
    authDomain: "painel-resumo-inteligente.firebaseapp.com",
    projectId: "painel-resumo-inteligente",
    storageBucket: "painel-resumo-inteligente.appspot.com",
    messagingSenderId: "949344025047",
    appId: "1:949344025047:web:5936b084ded1d70518b392"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);

  const loginContainer = document.getElementById("login-container");
  const menu = document.getElementById("menu");
  const adminSection = document.getElementById("adminSection");

  document.getElementById("loginTab").addEventListener("click", showLogin);
  document.getElementById("registerTab").addEventListener("click", showRegister);
  document.getElementById("loginBtn").addEventListener("click", login);
  document.getElementById("registerBtn").addEventListener("click", register);
  document.getElementById("logoutBtn").addEventListener("click", logout);
  document.getElementById("adminPanel").addEventListener("click", toggleAdminPanel);

  function showLogin() {
    document.getElementById("login-form").style.display = "block";
    document.getElementById("register-form").style.display = "none";
    document.getElementById("loginTab").classList.add("active");
    document.getElementById("registerTab").classList.remove("active");
  }

  function showRegister() {
    document.getElementById("login-form").style.display = "none";
    document.getElementById("register-form").style.display = "block";
    document.getElementById("registerTab").classList.add("active");
    document.getElementById("loginTab").classList.remove("active");
  }

  async function register() {
    const name = document.getElementById("register-name").value.trim();
    const email = document.getElementById("register-email").value.trim();
    const password = document.getElementById("register-password").value.trim();
    const errorMsg = document.getElementById("register-error");
    const successMsg = document.getElementById("register-success");
    errorMsg.textContent = "";
    successMsg.textContent = "";

    try {
      const userCred = await createUserWithEmailAndPassword(auth, email, password);
      await setDoc(doc(db, "users", userCred.user.uid), { name, email });
      successMsg.textContent = "✅ Conta criada com sucesso!";
      setTimeout(() => showLogin(), 1500);
    } catch (error) {
      errorMsg.textContent = error.message.includes("email")
        ? "E-mail já está em uso."
        : "Erro ao criar conta.";
    }
  }

  async function login() {
    const email = document.getElementById("login-email").value.trim();
    const password = document.getElementById("login-password").value.trim();
    const errorMsg = document.getElementById("login-error");
    errorMsg.textContent = "";

    try {
      const userCred = await signInWithEmailAndPassword(auth, email, password);
      loginContainer.style.display = "none";
      menu.style.display = "flex";
      showMenu(userCred.user);
    } catch {
      errorMsg.textContent = "E-mail ou senha incorretos.";
    }
  }

  function logout() {
    signOut(auth);
    menu.style.display = "none";
    loginContainer.style.display = "flex";
  }

  function showMenu(user) {
    document.getElementById("welcome-text").textContent =
      user.email === "zshowerpvp1@gmail.com"
        ? "Bem-vindo, Administrador!"
        : `Bem-vindo!`;
    document.getElementById("user-email-text").textContent = user.email;
    document.getElementById("adminPanel").style.display =
      user.email === "zshowerpvp1@gmail.com" ? "block" : "none";
  }

  async function toggleAdminPanel() {
    adminSection.style.display =
      adminSection.style.display === "block" ? "none" : "block";
    if (adminSection.style.display === "block") renderUserList();
  }

  async function renderUserList() {
    const tbody = document.querySelector("#userList tbody");
    tbody.innerHTML = "";
    const snapshot = await getDocs(collection(db, "users"));
    snapshot.forEach(docSnap => {
      const user = docSnap.data();
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td>${user.name}</td>
        <td>${user.email}</td>
        <td>${
          user.email !== "zshowerpvp1@gmail.com"
            ? `<button class='delete-btn' data-uid='${docSnap.id}' data-email='${user.email}'>Excluir</button>`
            : `<em>Administrador</em>`
        }</td>`;
      tbody.appendChild(tr);
    });

    document.querySelectorAll(".delete-btn").forEach(btn => {
      btn.addEventListener("click", async () => {
        const uid = btn.dataset.uid;
        await deleteDoc(doc(db, "users", uid));
        renderUserList();
      });
    });
  }

  document.getElementById("accessSimulationBtn").addEventListener("click", () => {
    window.location.href = "https://resumointeligente.github.io/quiz/";
  });
</script>

</body>
</html>
